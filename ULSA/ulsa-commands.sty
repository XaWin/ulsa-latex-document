\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{ULSA/ulsa-commands}[2018/06/01 v1.0)]

\newcommand{\preambule}{
    \makecustomtitle%
    \clearpage%
    {
    \pagestyle{empty}              % Removes numbers from middle pages.
    \fancypagestyle{plain}         % Re-definition removes numbers from first page.
    {
    \fancyhf{}%                       % Clear all header and footer fields.
    \renewcommand{\headrulewidth}{0pt}% Clear rules (remove these two lines if not desired).
    \renewcommand{\footrulewidth}{0pt}%
    }
    \tableofcontents%
    \thispagestyle{empty}          % Removes numbers from last page.
    \clearpage%
    }
}

\newcommand{\makecustomtitle}{
    \newgeometry{margin = 2.5cm} % Reset the margins for the title
    \import{ULSA/}{ulsa-titre.tex}%
    \restoregeometry
    }


\DeclareTextFontCommand{\textHeader}{\HeaderFont}


\newcommand{\TitleHeader}[1]{%
    \LARGE{\textHeader{\textcolor{ulsa}{#1}}}%
}
\newcommand{\SubtitleHeader}[1]{%
    \normalsize{\textHeader{#1}}%
}

\newcommand{\TitleMain}[1]{%
    \TitleHeader{#1}%
}
\newcommand{\SubtitleMain}[1]{%
    \large{#1}%
}



% https://tex.stackexchange.com/questions/122871/include-svg-images-with-the-svg-package/129854

% Definition for Warning Boxes
\mdfdefinestyle{warn}{%
  roundcorner=10pt,
  innertopmargin=10pt,
  innerbottommargin=10pt,
  innerleftmargin=10pt,  
  middlelinewidth=0pt,  
  skipabove=10pt
  skipbelow=10pt
  leftmargin=20pt,
  rightmargin=20pt,
  backgroundcolor=warning,
  font=\normalfont\large,
}

% Definition for Warning Boxes
\mdfdefinestyle{info}{%
  roundcorner=10pt,
  innertopmargin=10pt,
  innerbottommargin=10pt,
  innerleftmargin=10pt,  
  middlelinewidth=0pt,  
  skipabove=10pt
  skipbelow=10pt
  leftmargin=20pt,
  rightmargin=20pt,
  backgroundcolor=ulsasuperlight,
  font=\normalfont\large,
}

\newcommand{\attention}[1]{%
  \begin{mdframed}[style=warn]
  \begin{minipage}[c]{2cm}
    \includesvg[width=1.5cm,height=1.5cm]{ULSA/Exts/warning}
  \end{minipage}%
  \begin{minipage}[c]{\textwidth-2.5cm}#1\end{minipage}
  \end{mdframed}
}

\newcommand{\information}[1]{%
  \begin{mdframed}[style=info]
  \begin{minipage}[c]{2cm}
    \includesvg[width=1.5cm,height=1.5cm]{ULSA/Exts/info}
  \end{minipage}%
  \begin{minipage}[c]{\textwidth-2.5cm}#1\end{minipage}
  \end{mdframed}
}


%
% Modules Configuration
%
% This file must be UTF-8 encoded
\DTLsetseparator{;}
\DTLloaddb{dbUlsaModule}{ULSA/Exts/modules.csv}

\DTLnewdb{dbUlsaSemester}
\DTLnewrow{dbUlsaSemester}
\DTLnewdbentry{dbUlsaSemester}{key}{sp}
\DTLnewdbentry{dbUlsaSemester}{value}{Semestre de Printemps}
\DTLnewrow{dbUlsaSemester}
\DTLnewdbentry{dbUlsaSemester}{key}{SP}
\DTLnewdbentry{dbUlsaSemester}{value}{Semestre de Printemps}
\DTLnewrow{dbUlsaSemester}
\DTLnewdbentry{dbUlsaSemester}{key}{sa}
\DTLnewdbentry{dbUlsaSemester}{value}{Semestre d'Automne}
\DTLnewrow{dbUlsaSemester}
\DTLnewdbentry{dbUlsaSemester}{key}{SA}
\DTLnewdbentry{dbUlsaSemester}{value}{Semestre d'Automne}


%
% Title Options
%
\DTLnewdb{dbUlsaTitleOptions}

\newcommand{\setTitleOption}[2]{%
    \DTLnewrow{dbUlsaTitleOptions}
    \DTLnewdbentry{dbUlsaTitleOptions}{key}{#1}
    \DTLnewdbentry{dbUlsaTitleOptions}{value}{#2}
}

\newcommand{\getTitleOption}[1]{%
    \DTLfetch{dbUlsaTitleOptions}{key}{#1}{value}
}

\newcommand{\setModule}[1]{%
    % retrieving and adding the 
    \setTitleOption{module}{\DTLfetch{dbUlsaModule}{shortcode}{#1}{module}}
    % retrieving and adding the 
    \setTitleOption{moduleName}{\DTLfetch{dbUlsaModule}{shortcode}{#1}{name}}
}

\newcommand{\setSemester}[2]{%
    \setTitleOption{semester}{\DTLfetch{dbUlsaSemester}{key}{#1}{value} #2}
}


%
% Editors Listing
%
\DTLnewdb{editorlist}

\newcommand{\addEditor}[2]{%
    \DTLnewrow{editorlist}
    \DTLnewdbentry{editorlist}{first}{#1}
    \DTLnewdbentry{editorlist}{last}{#2}
}

\newcommand{\displayEditors}{%
    \ifthenelse{\equal{\DTLrowcount{editorlist}}{0}}%
    {\textit{Sans Ã©diteur}}
    {\DTLsort{last}{editorlist}% Sort list by name
    \DTLforeach*{editorlist}{\LastName=last,\FirstName=first}{%
        \FirstName \: \textsc{\LastName}\\ }% Print each item}%
    }}%

%
% Authors Listing
%
\DTLnewdb{authorlist}

\newcommand{\addAuthor}[2]{%
    \DTLnewrow{authorlist}
    \DTLnewdbentry{authorlist}{first}{#1}
    \DTLnewdbentry{authorlist}{last}{#2}
}

\newcommand{\displayAuthors}{%
    \ifthenelse{\equal{\DTLrowcount{authorlist}}{0}}%
    {\textit{Sans auteur}}
    {\DTLsort{last}{authorlist}% Sort list by name
    \DTLforeach*{authorlist}{\LastName=last,\FirstName=first}{%
        \FirstName \: \textsc{\LastName} \\ }% Print each item
    }%
}